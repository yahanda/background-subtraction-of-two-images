# A simple Python flask application to upload files and perform background subtraction

## Steps
1. Create env file.
    ```
    cp .env.sample .env
    ```
1. Go to Azure portal and create a Storage Account.
1. Createa a Blob Container in the Storage Account.
1. Find the api access key from the Azure storage dashboard.
1. Copy paste the account name, account key, connection string, and container name in the .env.
1. Go to Azure portal and create a Container Registry.
1. Build an image and push it to Container Registry.
    ```
    docker login <myregistry>.azurecr.io --username <acr_username> --password <acr_password>
    docker build -t background-subtraction .
    docker tag background-subtraction <myregistry>.azurecr.io/background-subtraction:latest
    docker push <myregistry>.azurecr.io/background-subtraction:latest
    ```
1. Create a WebApp and deploy it.
    ```
    az appservice plan create --name <plan_name> --resource-group <resource_group> --sku F1 --is-linux

    az webapp create --name <app_name> --resource-group <resource_group> --plan <plan_name> --deployment-container-image-name <myregistry>.azurecr.io/background-subtraction:latest

    az webapp config container set --name <app_name> --resource-group <resource_group> --docker-custom-image-name <myregistry>.azurecr.io/background-subtraction:latest --docker-registry-server-url https://<myregistry>.azurecr.io --docker-registry-server-user <acr_username> --docker-registry-server-password <acr_password>

    az webapp config appsettings set --name <app_name> --resource-group <resource_group> --settings WEBSITES_PORT=5000

    az webapp log config --name <app_name> --resource-group <resource_group> --docker-container-logging filesystem
    ```
    To open the log stream generated by your web app, you should use the following command.
    ```
    az webapp log tail --name <app_name> --resource-group <resource_group>
    ```
1. Go to the link below, upload your images and send it.
    ```
    https://<app_name>.azurewebsites.net
    ```
    